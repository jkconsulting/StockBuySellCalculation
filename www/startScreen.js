/*
 * JS for startScreen generated by Appery.io
 */

Apperyio.getProjectGUID = function() {
    return 'fb2e4058-2c6c-4743-ad25-a4cb3eb624a5';
};

function navigateTo(outcome, useAjax) {
    Apperyio.navigateTo(outcome, useAjax);
}

function adjustContentHeight() {
    Apperyio.adjustContentHeightWithPadding();
}

function adjustContentHeightWithPadding(_page) {
    Apperyio.adjustContentHeightWithPadding(_page);
}

function setDetailContent(pageUrl) {
    Apperyio.setDetailContent(pageUrl);
}

Apperyio.AppPages = [{
    "name": "startScreen",
    "location": "startScreen.html"
}, {
    "name": "Screen1",
    "location": "Screen1.html"
}];

function startScreen_js() {

    /* Object & array with components "name-to-id" mapping */
    var n2id_buf = {
        'btnBuy': 'startScreen_btnBuy',
        'mobilegrid_8': 'startScreen_mobilegrid_8',
        'mobilegridcell_9': 'startScreen_mobilegridcell_9',
        'mobilelabel_21': 'startScreen_mobilelabel_21',
        'mobilegridcell_10': 'startScreen_mobilegridcell_10',
        'mobilelabel_22': 'startScreen_mobilelabel_22',
        'mobilegridcell_13': 'startScreen_mobilegridcell_13',
        'mobilelabel_23': 'startScreen_mobilelabel_23',
        'mobilegridcell_11': 'startScreen_mobilegridcell_11',
        'txtAvailAmt': 'startScreen_txtAvailAmt',
        'mobilegridcell_12': 'startScreen_mobilegridcell_12',
        'txtTransactionCost': 'startScreen_txtTransactionCost',
        'mobilegridcell_14': 'startScreen_mobilegridcell_14',
        'txtStockPrice': 'startScreen_txtStockPrice',
        'mobilegridcell_15': 'startScreen_mobilegridcell_15',
        'label3': 'startScreen_label3',
        'mobilegridcell_16': 'startScreen_mobilegridcell_16',
        'label2': 'startScreen_label2',
        'mobilegridcell_17': 'startScreen_mobilegridcell_17',
        'label1': 'startScreen_label1',
        'mobilegridcell_18': 'startScreen_mobilegridcell_18',
        'lblAmtLeft': 'startScreen_lblAmtLeft',
        'mobilegridcell_19': 'startScreen_mobilegridcell_19',
        'lblTotalCost': 'startScreen_lblTotalCost',
        'mobilegridcell_20': 'startScreen_mobilegridcell_20',
        'lblNumShares': 'startScreen_lblNumShares',
        'btnSell': 'startScreen_btnSell',
        'mobilegrid_25': 'startScreen_mobilegrid_25',
        'mobilegridcell_26': 'startScreen_mobilegridcell_26',
        'lblSellNumShares': 'startScreen_lblSellNumShares',
        'mobilegridcell_27': 'startScreen_mobilegridcell_27',
        'lblSellCost': 'startScreen_lblSellCost',
        'mobilegridcell_38': 'startScreen_mobilegridcell_38',
        'lblSellPurchasedPrice': 'startScreen_lblSellPurchasedPrice',
        'mobilegridcell_28': 'startScreen_mobilegridcell_28',
        'txtNumShares': 'startScreen_txtNumShares',
        'mobilegridcell_29': 'startScreen_mobilegridcell_29',
        'txtSellCost': 'startScreen_txtSellCost',
        'mobilegridcell_39': 'startScreen_mobilegridcell_39',
        'txtPurchasedPrice': 'startScreen_txtPurchasedPrice',
        'mobilegridcell_30': 'startScreen_mobilegridcell_30',
        'lblSellGainPct': 'startScreen_lblSellGainPct',
        'mobilegridcell_31': 'startScreen_mobilegridcell_31',
        'lblSellGainAmt': 'startScreen_lblSellGainAmt',
        'mobilegridcell_40': 'startScreen_mobilegridcell_40',
        'lblSellTargetPrice': 'startScreen_lblSellTargetPrice',
        'mobilegridcell_32': 'startScreen_mobilegridcell_32',
        'txtGainPct': 'startScreen_txtGainPct',
        'mobilegridcell_33': 'startScreen_mobilegridcell_33',
        'txtGainAmt': 'startScreen_txtGainAmt',
        'mobilegridcell_41': 'startScreen_mobilegridcell_41',
        'txtTargetPrice': 'startScreen_txtTargetPrice',
        'mobilegridcell_42': 'startScreen_mobilegridcell_42',
        'lblSellPriceDiff': 'startScreen_lblSellPriceDiff',
        'mobilegridcell_43': 'startScreen_mobilegridcell_43',
        'mobilelabel_57': 'startScreen_mobilelabel_57',
        'mobilegridcell_44': 'startScreen_mobilegridcell_44',
        'lblSellNetGain': 'startScreen_lblSellNetGain',
        'mobilegridcell_45': 'startScreen_mobilegridcell_45',
        'txtPriceDiff': 'startScreen_txtPriceDiff',
        'mobilegridcell_46': 'startScreen_mobilegridcell_46',
        'lblTransactionTotal': 'startScreen_lblTransactionTotal',
        'mobilegridcell_47': 'startScreen_mobilegridcell_47',
        'txtNetGain': 'startScreen_txtNetGain'
    };

    if ("n2id" in window && window.n2id !== undefined) {
        $.extend(n2id, n2id_buf);
    } else {
        window.n2id = n2id_buf;
    }

    if (navigator.userAgent.indexOf("IEMobile") != -1) {
        // Fixing issue https://github.com/jquery/jquery-mobile/issues/5424 on Windows Phone
        $("div[data-role='footer']").css("bottom", "-36px");
    }

    /*
     * Nonvisual components
     */

    Apperyio.mappings = Apperyio.mappings || {};

    Apperyio.datasources = Apperyio.datasources || {};

    Apperyio.CurrentScreen = 'startScreen';
    _.chain(Apperyio.mappings).filter(function(m) {
        return m.homeScreen === Apperyio.CurrentScreen;
    }).each(Apperyio.UIHandler.hideTemplateComponents);

    /*
     * Events and handlers
     */

    // On Load
    var startScreen_onLoad = function() {
            startScreen_elementsExtraJS();

            Appery('txtAvailAmt').blur(function() {
                Appery('txtAvailAmt').formatCurrency();
            });

            Appery('txtAvailAmt').focus(function() {
                Appery('txtAvailAmt').toNumber();
            });

            Appery('txtAvailAmt').change(function() {
                Appery('btnBuy').click();
            });
            ////////////////////////////////////////////////////////
            Appery('txtTransactionCost').blur(function() {
                Appery('txtTransactionCost').formatCurrency();
            });

            Appery('txtTransactionCost').focus(function() {
                Appery('txtTransactionCost').toNumber();
            });

            Appery('txtTransactionCost').change(function() {
                Appery('btnBuy').click();
            });
            ////////////////////////////////////////////////////////
            Appery('txtStockPrice').blur(function() {
                Appery('txtStockPrice').formatCurrency();
            });

            Appery('txtStockPrice').focus(function() {
                Appery('txtStockPrice').toNumber();
            });

            Appery('txtStockPrice').change(function() {
                Appery('btnBuy').click();
            });
            ////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////
            ////////////////////////////////////////////////////////
            Appery('txtTargetPrice').blur(function() {
                Appery('txtTargetPrice').formatCurrency();
            });

            Appery('txtTargetPrice').focus(function() {
                Appery('txtTargetPrice').toNumber();
            });

            Appery('txtTargetPrice').change(function() {
                sellStockCalculation("TargetPrice");
            });
            ////////////////////////////////////////////////////////
            Appery('txtPurchasedPrice').blur(function() {
                Appery('txtPurchasedPrice').formatCurrency();
            });

            Appery('txtPurchasedPrice').focus(function() {
                Appery('txtPurchasedPrice').toNumber();
            });

            Appery('txtPurchasedPrice').change(function() {
                sellStockCalculation("PurchasedPrice");
            });
            ////////////////////////////////////////////////////////
            Appery('txtSellCost').blur(function() {
                Appery('txtSellCost').formatCurrency();
            });

            Appery('txtSellCost').focus(function() {
                Appery('txtSellCost').toNumber();
            });

            Appery('txtSellCost').change(function() {
                sellStockCalculation("Cost");
            });
            ////////////////////////////////////////////////////////
            Appery('txtPriceDiff').blur(function() {
                Appery('txtPriceDiff').formatCurrency();
            });

            Appery('txtPriceDiff').focus(function() {
                Appery('txtPriceDiff').toNumber();
            });

            Appery('txtPriceDiff').change(function() {
                sellStockCalculation("PriceDiff");
            });
            ////////////////////////////////////////////////////////
            Appery('txtGainPct').blur(function() {
                Appery('txtGainPct').format('0.00%');
            });

            Appery('txtGainPct').focus(function() {
                Appery('txtGainPct').unformat();
            });

            Appery('txtGainPct').change(function() {
                sellStockCalculation("GainPct");
            });
            ////////////////////////////////////////////////////////
            Appery('txtGainAmt').blur(function() {
                Appery('txtGainAmt').formatCurrency();
            });

            Appery('txtGainAmt').focus(function() {
                Appery('txtGainAmt').toNumber();
            });

            Appery('txtGainAmt').change(function() {
                sellStockCalculation("GainAmt");
            });
            ////////////////////////////////////////////////////////
            Appery('txtNetGain').blur(function() {
                Appery('txtNetGain').formatCurrency();
            });

            Appery('txtNetGain').focus(function() {
                Appery('txtNetGain').toNumber();
            });

            Appery('txtNetGain').change(function() {
                sellStockCalculation("NetGain");
            });
            ////////////////////////////////////////////////////////
            loadBuyStockValues();
            loadSellStockValues();;

            startScreen_deviceEvents();
            startScreen_windowEvents();
            startScreen_elementsEvents();
        };

    // screen window events


    function startScreen_windowEvents() {

        $('#startScreen').bind('pageshow orientationchange', function() {
            var _page = this;
            adjustContentHeightWithPadding(_page);
        });

    };

    // device events


    function startScreen_deviceEvents() {
        document.addEventListener("deviceready", function() {

        });
    };

    // screen elements extra js


    function startScreen_elementsExtraJS() {
        // screen (startScreen) extra code

    };

    // screen elements handler


    function startScreen_elementsEvents() {
        $(document).on("click", "a :input,a a,a fieldset label", function(event) {
            event.stopPropagation();
        });

        $(document).off("click", '#startScreen_mobilecontainer [name="btnBuy"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    buyStockCalculation();

                }
            },
        }, '#startScreen_mobilecontainer [name="btnBuy"]');

        $(document).off("blur", '#startScreen_mobilecontainer [name="txtAvailAmt"]').on({
            blur: function(event) {
                $('.txtAvailAmt').formatCurrency();
            },
        }, '#startScreen_mobilecontainer [name="txtAvailAmt"]');

        $(document).off("click", '#startScreen_mobilecontainer [name="btnSell"]').on({
            click: function(event) {
                if (!$(this).attr('disabled')) {
                    sellStockCalculation();

                }
            },
        }, '#startScreen_mobilecontainer [name="btnSell"]');

    };

    $(document).off("pagebeforeshow", "#startScreen").on("pagebeforeshow", "#startScreen", function(event, ui) {
        Apperyio.CurrentScreen = "startScreen";
        _.chain(Apperyio.mappings).filter(function(m) {
            return m.homeScreen === Apperyio.CurrentScreen;
        }).each(Apperyio.UIHandler.hideTemplateComponents);
    });

    startScreen_onLoad();
};

$(document).off("pagecreate", "#startScreen").on("pagecreate", "#startScreen", function(event, ui) {
    Apperyio.processSelectMenu($(this));
    startScreen_js();
});